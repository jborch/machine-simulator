<div class="m-14 flex items-start gap-8">
  <div class="w-40">
    <button
      (click)="toggle()"
      class="px-4 py-1.5 border border-gray-400 rounded bg-white cursor-pointer hover:bg-gray-100 active:bg-gray-200"
    >
      {{ snapped() ? 'Reset' : 'Snap Cap' }}
    </button>

    <label class="mt-4 block text-sm">Cap position: {{ capPercent() }}%</label>
    <input
      type="range"
      [min]="CAP_POSITION_MIN"
      [max]="CAP_POSITION_MAX"
      [value]="capPercent()"
      (input)="onSliderInput($event)"
      class="w-full mt-1"
    />

    <label class="mt-4 block text-sm">Pen tilt: {{ penTilt() }}&deg;</label>
    <input
      type="range"
      [min]="TILT_MIN"
      [max]="TILT_MAX"
      [step]="TILT_STEP"
      [value]="penTilt()"
      (input)="onTiltInput($event)"
      class="w-full mt-1"
    />

    <label class="mt-4 block text-sm">Pen X: {{ penOffsetX() }}px</label>
    <input
      type="range"
      [min]="OFFSET_MIN"
      [max]="OFFSET_MAX"
      [value]="penOffsetX()"
      (input)="onPenOffsetInput('x', $event)"
      class="w-full mt-1"
    />

    <label class="mt-2 block text-sm">Pen Y: {{ penOffsetY() }}px</label>
    <input
      type="range"
      [min]="OFFSET_MIN"
      [max]="OFFSET_MAX"
      [value]="penOffsetY()"
      (input)="onPenOffsetInput('y', $event)"
      class="w-full mt-1"
    />

    <label class="mt-4 block text-sm">Cap X: {{ capOffsetX() }}px</label>
    <input
      type="range"
      [min]="OFFSET_MIN"
      [max]="OFFSET_MAX"
      [value]="capOffsetX()"
      (input)="onCapOffsetInput('x', $event)"
      class="w-full mt-1"
    />

    <label class="mt-2 block text-sm">Cap Y: {{ capOffsetY() }}px</label>
    <input
      type="range"
      [min]="OFFSET_MIN"
      [max]="OFFSET_MAX"
      [value]="capOffsetY()"
      (input)="onCapOffsetInput('y', $event)"
      class="w-full mt-1"
    />
  </div>

  <div
    class="overflow-hidden"
    [style.width.px]="510 * VISUAL_SCALE"
    [style.height.px]="2320 * VISUAL_SCALE"
  >
    <div
      class="relative border border-dashed border-gray-400 origin-top-left"
      style="width: 510px; height: 2320px"
      [style.transform]="'scale(' + VISUAL_SCALE + ')'"
    >
      <app-cap
        class="block absolute left-0 top-0 z-10"
        [style.opacity]="CAP_OPACITY"
        [style.transform]="
          'translate(' + capOffsetX() + 'px,' + (capTranslateY() + capOffsetY()) + 'px)'
        "
      />
      <app-pen
        class="block absolute left-[30px] top-[520px]"
        style="transform-origin: 225px 900px"
        [style.transform]="
          'translate(' + penOffsetX() + 'px,' + penOffsetY() + 'px) rotate(' + penTilt() + 'deg)'
        "
      />
    </div>
  </div>

  <div>
    <div class="text-sm font-semibold">Overlap</div>
    <div class="text-2xl">{{ overlapPixelCount() }}</div>
    <div class="text-xs text-gray-500 mb-4">pixels</div>
    <app-overlap-graph [dataPoints]="overlapHistory()" />
  </div>
</div>
